<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="stylesheet" href="assets/css/layui.css" />
    <link rel="stylesheet" href="assets/css/view.css" />
    <title></title>
  </head>
  <body class="layui-view-body">
    <script src="./assets/echarts.js"></script>

    <div class="layui-content">
      <div class="layui-row layui-col-space20">
        <div class="layui-col-sm6 layui-col-md3">
          <div class="layui-card">
            <div class="layui-card-body chart-card">
              <div class="chart-header">
                <div class="metawrap">
                  <div class="meta">
                    <span>GARAGE SENSOR</span>
                  </div>
                  <div class="total">movement</div>
                </div>
              </div>
              <div class="chart-body">
                <div class="contentwrap"></div>
              </div>
              <div class="chart-footer">
                <div id="layerDemo" style="margin-bottom: 0">
                  <button data-method="setTop" class="layui-btn">
                    view history
                  </button>
                  <form class="layui-form layui-card-body" action="">
                    <input
                      type="checkbox"
                      name="switch"
                      lay-skin="switch"
                      lay-text="ON|OFF"
                    />
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="layui-col-sm6 layui-col-md3">
          <div class="layui-card">
            <div class="layui-card-body chart-card">
              <div class="chart-header">
                <div class="metawrap">
                  <div class="meta">
                    <span>WINDOW SENSOR</span>
                  </div>
                  <div class="total">movement</div>
                </div>
              </div>
              <div class="chart-body">
                <div class="contentwrap"></div>
              </div>
              <div class="chart-footer">
                <div id="layerDemo" style="margin-bottom: 0">
                  <button data-method="setTop" class="layui-btn">
                    view history
                  </button>
                  <form class="layui-form layui-card-body" action="">
                    <input
                      type="checkbox"
                      name="switch"
                      lay-skin="switch"
                      lay-text="ON|OFF"
                    />
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="layui-col-sm6 layui-col-md3">
          <div class="layui-card">
            <div class="layui-card-body chart-card">
              <div class="chart-header">
                <div class="metawrap">
                  <div class="meta">
                    <span>SMOKE SENSOR</span>
                  </div>
                  <div class="total">smokeScope</div>
                </div>
              </div>
              <div class="chart-body">
                <div class="contentwrap"></div>
              </div>
              <div class="chart-footer">
                <div id="layerDemo" style="margin-bottom: 0">
                  <button data-method="setTop" class="layui-btn">
                    view history
                  </button>
                  <form class="layui-form layui-card-body" action="">
                    <input
                      type="checkbox"
                      name="switch"
                      lay-skin="switch"
                      lay-text="ON|OFF"
                    />
                  </form>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="layui-col-sm6 layui-col-md3">
          <div class="layui-card">
            <div class="layui-card-body chart-card">
              <div class="chart-header">
                <div class="metawrap">
                  <div class="meta">
                    <span>DOOR SENSOR</span>
                  </div>
                  <div class="total">movement</div>
                </div>
              </div>
              <div class="chart-body">
                <div class="contentwrap"></div>
              </div>
              <div class="chart-footer">
                <div id="layerDemo" style="margin-bottom: 0">
                  <button data-method="setTop" class="layui-btn">
                    view history
                  </button>
                </div>
                <form class="layui-form layui-card-body" action="">
                  <input
                    type="checkbox"
                    name="switch"
                    lay-skin="switch"
                    lay-text="ON|OFF"
                  />
                </form>
              </div>
            </div>
          </div>
        </div>

        <div class="layui-col-sm6 layui-col-md3">
          <div class="layui-card">
            <div class="layui-card-body chart-card">
              <div class="chart-header">
                <div class="metawrap">
                  <div class="meta">
                    <span>LIGHT</span>
                  </div>
                  <div class="total">Lightness</div>
                </div>
              </div>

              <div class="chart-body">
                <div class="contentwrap"></div>
              </div>
              <div class="chart-footer">
                <button data-method="setTop" class="layui-btn">
                  view history
                </button>

                <form class="layui-form layui-card-body" action="">
                  <input
                    type="checkbox"
                    name="switch"
                    lay-skin="switch"
                    lay-text="ON|OFF"
                  />
                </form>
              </div>
            </div>
          </div>
        </div>

        <div class="layui-col-sm6 layui-col-md3">
          <div class="layui-card">
            <div class="layui-card-body chart-card">
              <div class="chart-header">
                <div class="metawrap">
                  <div class="meta">
                    <span>TEMPERATURE SENSOR</span>
                  </div>
                  <div class="total">Temperature</div>
                </div>
              </div>
              <div class="chart-body">
                <div class="contentwrap"></div>
              </div>

              <div class="chart-footer">
                <div id="layerDemo" style="margin-bottom: 0">
                  <button data-method="setTop" class="layui-btn">
                    view history
                  </button>
                  <input type="range" min="0" max="100" value="70" />
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="layui-col-sm6 layui-col-md3">
          <div class="layui-card">
            <div class="layui-card-body chart-card">
              <div class="chart-header">
                <div class="metawrap">
                  <div class="meta">
                    <span>HUMIDITY SENSOR</span>
                  </div>
                  <div class="total">Humidity</div>
                </div>
              </div>
              <div class="chart-body">
                <div class="contentwrap"></div>
              </div>
              <div class="chart-footer">
                <div id="layerDemo" style="margin-bottom: 0">
                  <button data-method="setTop" class="layui-btn">
                    view history
                  </button>
                  <input type="range" min="0" max="100" value="70" />
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="assets/layui.all.js"></script>
    <script>
      var element = layui.element;
    </script>
    <script>
      layui.use("layer", function () {
        //独立版的layer无需执行这一句
        var $ = layui.jquery,
          layer = layui.layer; //独立版的layer无需执行这一句

        //触发事件
        var active = {
          setTop: function () {
            var that = this;
            //多窗口模式，层叠置顶
            layer.open({
              type: 1, //此处以iframe举例
              title: "Hardware's detail",
              area: ["390px", "260px"],
              shade: 0,
              maxmin: true,
              content:
                '<div style="width: 100%; height: 100%" id ="div_chart">' +
                "<center>" +
                '<button type="button" class="layui-btn layui-btn-lg layui-btn-radius layui-btn-normal" onclick ="drawchart()">view history</button>' +
                "<center/>" +
                "</div>",

              yes: function () {
                $(that).click();
              },
              btn2: function () {
                layer.closeAll();
              },

              zIndex: layer.zIndex, //重点1
              success: function (layero, index) {
                layer.setTop(layero); //重点2. 保持选中窗口置顶

                //记录索引，以便按 esc 键关闭。事件见代码最末尾处。
                layer.escIndex = layer.escIndex || [];
                layer.escIndex.unshift(index);
                //选中当前层时，将当前层索引放置在首位
                layero.on("mousedown", function () {
                  var _index = layer.escIndex.indexOf(index);
                  if (_index !== -1) {
                    layer.escIndex.splice(_index, 1); //删除原有索引
                  }
                  layer.escIndex.unshift(index); //将索引插入到数组首位
                });

                var mCharts = echarts.init(
                  document.getElementById("div_chart")
                );
                var xDataArr = ["1点", "2点", "3点"];
                var yDataArr = [300, 180, 270];
                var option = {
                  xAxis: {
                    type: "category",
                    data: xDataArr,
                  },
                  yAxis: {
                    type: "value",
                  },
                  series: [
                    {
                      type: "line",
                      data: yDataArr,
                    },
                  ],
                };
                mCharts.setOption(option);
              },
              end: function () {
                //更新索引
                if (typeof layer.escIndex === "object") {
                  layer.escIndex.splice(0, 1);
                }
              },
            });
          },
        };

        $("#layerDemo .layui-btn").on("click", function () {
          var othis = $(this),
            method = othis.data("method");
          active[method] ? active[method].call(this, othis) : "";
        });

        //多窗口模式 - esc 键
        $(document).on("keyup", function (e) {
          if (e.keyCode === 27) {
            layer.close(layer.escIndex ? layer.escIndex[0] : 0);
          }
        });
      });
    </script>
  </body>
</html>
